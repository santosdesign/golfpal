<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <title>Golf Distance Drill</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #6B4EFF;
      --text-color: #333;
      --border-color: #E5E7EB;
      --light-bg: #F9FAFB;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: system-ui, -apple-system, sans-serif;
    }

    body {
      background: white;
      color: var(--text-color);
      font-family: 'Inter', sans-serif;
    }

    h1, h2, h3, p, li {
      font-family: 'Inter', sans-serif;
    }

    .step {
      display: none;
      height: 100vh;
      flex-direction: column;
      overflow: hidden;
    }

    .step.active {
      display: flex;
    }

    .section-top {
      padding: 12px 16px;
      background: white;
      width: 100%;
    }

    .section-middle {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      overflow: auto;
      min-height: 0;
      background: white;
    }

    .section-bottom {
      padding: 8px 0;
      background: white;
      border-top: 1px solid var(--border-color);
    }

    .nav-buttons {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 800px;
      margin: 0 auto;
      padding: 8px 12px;
      gap: 12px;
    }

    .step-indicator {
      color: var(--primary-color);
      font-weight: 500;
      font-size: 12px;
      margin-bottom: 4px;
    }

    .section-top h1 {
      font-size: 18px;
      margin: 0;
      color: var(--text-color);
    }

    .content-wrapper {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 24px;
    }

    /* Step 2 specific styles */
    #step-2 .section-middle {
      padding: 24px;
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      min-height: 0;
      overflow: auto;
    }

    .upload-container {
      width: 100%;
      height: 100%;
      max-width: min(400px, calc(100% - 48px));
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 24px;
    }

    .preview-wrapper {
      width: 100%; /* Full width */
      max-width: 100%; /* Prevent overflow */
    }

    .preview-area {
      position: relative; /* Position relative for absolute children */
      width: 100%; /* Full width */
      padding-top: 56.25%; /* 16:9 Aspect Ratio (9/16 = 0.5625) */
      border-radius: 12px; /* Rounded corners */
      overflow: hidden; /* Hide overflow */
    }

    .preview-area .preview-image {
      position: absolute; /* Position absolute to fill the container */
      top: 0;
      left: 0;
      width: 100%; /* Fill the container */
      height: 100%; /* Fill the container */
      object-fit: cover; /* Cover the area without distortion */
    }

    .preview-area.empty .preview-image {
      opacity: 0.9;
    }

    .preview-area.empty::after {
      display: none; /* Remove the overlay */
    }

    .preview-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      z-index: 1;
      width: 100%;
    }

    .upload-text {
      margin-top: 16px; /* Space between the image and text */
      text-align: center; /* Center the text */
    }

    .upload-text .main-text {
      color: black; /* Change title color to black */
    }

    .upload-text .subtitle {
      color: black; /* Change subtitle color to black */
    }

    .main-text {
      color: #fff;
      font-size: 18px;
      font-weight: 500;
      margin-bottom: 8px;
    }

    .subtitle {
      color: #fff;
      font-size: 14px;
      opacity: 0.6;
    }

    .upload-buttons-wrapper {
      display: flex;
      flex-direction: column; /* Stack buttons vertically */
      justify-content: center; /* Center the buttons */
      gap: 12px; /* Space between buttons */
      margin-top: 12px; /* Space above the buttons */
    }

    .upload-buttons-wrapper button {
      background: var(--light-bg);
      padding: 12px 24px;
      border-radius: 8px;
      border: none;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      height: 48px; /* Set a fixed height for all buttons */
    }

    .preview-area:not(.empty) .preview-content {
      bottom: 24px;
      top: auto;
      transform: translateX(-50%);
    }

    .preview-area:not(.empty) .upload-text {
      display: none;
    }

    .preview-area:not(.empty) .upload-buttons-wrapper button {
      padding: 8px 16px;
      font-size: 12px;
    }

    .preview-area:not(.empty) .preview-image {
      opacity: 1;
    }

    .camera-icon {
      width: 48px;
      height: 48px;
      margin-bottom: 8px;
    }

    .upload-text .subtitle {
      font-size: 0.9em;
      margin-top: 8px;
      opacity: 0.7;
    }

    .upload-buttons-wrapper {
      z-index: 1;
      width: 100%;
      max-width: 400px;
    }

    .upload-buttons {
      display: flex;
      gap: 8px;
      width: 100%;
    }

    .upload-buttons .button {
      flex: 1;
      padding: 8px 16px;
      font-size: 13px;
      min-height: 36px;
    }

    .photo-hint {
      display: none;
      font-size: 10px;
    }

    /* Responsive adjustments */
    @media (max-width: 480px) {
      #step-2 .section-middle {
        padding: 16px;
      }

      .content-wrapper {
        gap: 16px;
      }

      .upload-container {
        max-width: calc(100% - 32px);
        gap: 16px;
      }

      .upload-buttons {
        flex-direction: column;
        gap: 16px;
      }

      .upload-buttons .button {
        max-width: none;
      }
    }

    @media (max-width: 360px) {
      #step-2 .section-middle {
        padding: 12px;
      }

      .upload-container {
        max-width: calc(100% - 24px);
        gap: 12px;
      }

      .upload-buttons {
        gap: 12px;
      }
    }

    .club-selection {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
      padding: 0 24px;
    }

    .club-option {
      padding: 12px 24px;
      border-radius: 100px;
      border: 1px solid var(--border-color);
      background: white;
      color: var(--text-color);
      font-weight: 500;
      cursor: pointer;
      margin: 0;
      transition: all 0.2s;
      font-size: 14px;
      white-space: nowrap;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .club-option:hover {
      background: var(--light-bg);
    }

    .club-option.selected {
      background: var(--text-color);
      color: white;
      border-color: var(--text-color);
    }

    @media (max-width: 600px) {
      .club-selection {
        padding: 0 16px;
        gap: 6px;
      }

      .club-option {
        padding: 8px 16px;
        font-size: 12px;
      }
    }

    @media (max-width: 360px) {
      .club-selection {
        padding: 0 12px;
        gap: 4px;
      }

      .club-option {
        padding: 6px 12px;
        font-size: 12px;
      }
    }

    .back-button {
      color: var(--primary-color);
      padding: 8px 12px;
      border: none;
      background: none;
      font-weight: 500;
      cursor: pointer;
      transition: opacity 0.2s;
    }

    .back-button:hover {
      opacity: 0.8;
    }

    .button {
      padding: 8px 16px;
      border-radius: 100px;
      border: 1px solid var(--border-color);
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
      letter-spacing: 0.5px;
      transition: all 0.2s;
      background: white;
      color: var(--text-color);
      text-align: center;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      min-height: 36px;
    }

    .button.primary {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }

    .button.primary:hover {
      background: #5b3eff;
    }

    .button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .vertical-guides {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      pointer-events: none;
      z-index: 1;
    }

    .guide {
      flex: 1;
      border-right: 2px dashed rgba(107, 78, 255, 0.3);
    }

    .guide:last-child {
      border-right: none;
    }

    /* Touch device optimizations */
    @media (hover: none) and (pointer: coarse) {
      .preview-area {
        touch-action: none;
        -webkit-overflow-scrolling: touch;
      }

      .preview-area img {
        will-change: transform;
      }
    }

    /* Step 5 styles */
    #step-5 .section-middle {
      padding: 24px;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      min-height: 0;
      overflow: auto;
    }

    #step-5 .content-wrapper {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .confirm-container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: row;
      gap: 24px;
      margin: 0 auto;
    }

    .club-summary,
    .photo-preview {
      flex: 1;
      border-radius: 12px;
      display: flex;
      width: 50%;
      padding-top: 56.25%;
      flex-direction: column;
      justify-content: space-between;
      padding: 12px;
      background-color: #6c4eff08;
      box-sizing: border-box;
    }

    .club-summary h2 {
      font-size: 14px;
      margin: 0;
      color: var(--text-color);
    }

    .selected-clubs-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      max-height: 200px;
      overflow-y: auto;
      padding-right: 8px;
    }

    .club-pill {
      padding: 8px 16px;
      border-radius: 100px;
      background: rgb(255, 255, 255);
      color: var(--text-color);
      font-size: 14px;
      white-space: nowrap;
    }

    .edit-clubs,
    .edit-field {
      background: white;
      color: #5B3DDE;
      padding: 12px 24px;
      border-radius: 8px;
      border: 0.5px solid #5B3DDE;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .edit-clubs:hover,
    .edit-field:hover {
      background: #f0f0f0;
    }

    .edit-clubs {
      margin-top: 12px; /* Add margin to create separation */
    }

    .photo-preview {
      position: relative; /* Position relative for absolute children */
      width: 100%; /* Full width */
      padding-top: 56.25%; /* 16:9 Aspect Ratio (9/16 = 0.5625) */
      overflow: hidden; /* Hide overflow */
      border-radius: 12px; /* Rounded corners */
      margin-bottom: 12px; /* Space below the image */
    }

    .photo-preview img {
      position: absolute; /* Position absolute to fill the container */
      top: 0;
      left: 0;
      width: 100%; /* Fill the container */
      height: 100%; /* Fill the container */
      object-fit: cover; /* Cover the area without distortion */
    }

    .field-interaction {
      position: relative; /* Position relative for absolute children */
      width: 100%; /* Full width */
      padding-top: 56.25%; /* 16:9 Aspect Ratio (9/16 = 0.5625) */
      overflow: hidden; /* Hide overflow */
      border-radius: 12px; /* Rounded corners */
    }

    .field-interaction img {
      position: absolute; /* Position absolute to fill the container */
      top: 0;
      left: 0;
      width: 100%; /* Fill the container */
      height: 100%; /* Fill the container */
      object-fit: cover; /* Cover the area without distortion */
    }

    @media (max-width: 768px) {
      .confirm-container {
        flex-direction: flex;
      }

      .photo-preview {
        width: 100%;
        max-width: 400px;
      }
    }

    @media (max-width: 480px) {
      #step-5 .section-middle {
        padding: 16px;
      }

      .confirm-container {
        max-width: calc(100% - 32px);
        gap: 16px;
      }

      .club-summary {
        padding: 16px;
      }
    }

    @media (max-width: 360px) {
      #step-5 .section-middle {
        padding: 12px;
      }

      .confirm-container {
        max-width: calc(100% - 24px);
        gap: 12px;
      }

      .club-summary {
        padding: 12px;
      }
    }

    /* Drill interface styles */
    .drill-container {
      width: 100%; /* Full width */
      height: 100%; /* Full height */
      display: flex; /* Use flexbox for alignment */
      flex-direction: row; /* Align children horizontally */
      gap: 24px; /* Space between children */
      margin: 0 auto; /* Center the container */
    }

    .instruction-panel {
      flex: 1; /* Allow both children to take equal space */
      display: flex; /* Use flexbox for child elements */
      flex-direction: column; /* Stack elements vertically within each child */
      justify-content: space-between; /* Align items at the start */
      box-sizing: border-box; /* Include padding and border in width/height */
      border-radius: 12px;
      background-color: #6c4eff08;
      padding: 12px; /* Add 12px padding */
    }
    .field-interaction {
      flex: 1; /* Allow both children to take equal space */
      display: flex; /* Use flexbox for child elements */
      flex-direction: column; /* Stack elements vertically within each child */
      justify-content: space-between; /* Align items at the start */
      box-sizing: border-box; /* Include padding and border in width/height */
      border-radius: 12px;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .score-tracker {
      font-size: 14px;
      color: var(--primary-color);
      font-weight: 500;
    }

    .instruction {
      font-size: 14px;
      font-weight: 500;
      line-height: 1.4;
      margin: 6px 0;
    }

    .highlight {
      text-decoration: underline;
      font-weight: 600;
    }

    .prompt {
      margin-top: auto;
    }

    .prompt h3 {
      font-size: 12px;
      margin-bottom: 8px;
      color: #5B3DDE;
    }

    .hint {
      font-size: 14px;
      color: var(--text-color);
      opacity: 0.7;
      color: #5B3DDE;
      opacity: 50%;
    }

    .field-container {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: 8px;
      overflow: hidden;
    }

    .field-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .interactive-zones {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
    }

    .zone {
      flex: 1;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      outline: 1px solid rgba(107, 78, 255, 0.5);
      box-sizing: border-box;
    }

    .zone.highlighted {
      background-color: rgba(107, 78, 255, 0.4); /* Main purple with 40% opacity */
    }
    .aim-here-text {
      position: absolute;
      bottom: 8px; /* Adds a bit of margin at the bottom */
      left: 50%;
      transform: translateX(-50%);
      white-space: nowrap; /* Prevents wrapping */
      color: white;
      font-weight: 600;
      font-size: 8px;
      display: none;
      background-color: rgba(0, 0, 0, 0.6); /* Semi-transparent background */
      padding: 6px 10px; /* Padding to emulate a chip */
      border-radius: 24px; /* Rounded corners for the chip effect */
    }

    .zone.highlighted .aim-here-text {
      display: block; /* Show when highlighted */
    }

    .zone:hover {
      background-color: rgba(107, 78, 255, 0.1);
    }

    .zone.correct {
      background-color: rgba(34, 197, 94, 0.2);
    }

    .zone.incorrect {
      background-color: rgba(239, 68, 68, 0.2);
    }

    .zone-label {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-weight: 500;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
      opacity: 0.7;
    }

    .parent-container {
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      height: 100%;
      width: 100%;
    }

    .feedback-message {
      opacity: 0;
      transition: opacity 0.5s ease;
      font-size: 12px;
      display: none;
      margin-top: auto;
      border-radius: 6px;
      padding: 6px;
      background-color: #f0f0f0;
      width: 100%;
      align-self: flex-end;
    }

    .feedback-message.visible {
      opacity: 1;
      display: block;
    }

    .prompt,
    .hint {
      transition: opacity 0.5s ease;
    }

    .prompt.hidden,
    .hint.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .feedback-message.success {
      background: rgba(34, 197, 94, 0.1);
      color: rgb(34, 197, 94);
      opacity: 1;
    }

    .feedback-message.error {
      background: rgba(239, 68, 68, 0.1);
      color: rgb(239, 68, 68);
      opacity: 1;
    }

    @media (max-width: 768px) {
      .drill-container {
        flex-direction: row;
      }

      .instruction-panel {
        flex: none;
        width: 30%;
        border: #5B3DDE;
        border-radius: 4px;
        padding: 12px;
      }

      .field-interaction {
        aspect-ratio: 16/9;
      }
    }

    .learning-feedback {
      margin: 24px 0;
      padding: 16px;
      background: rgba(107, 78, 255, 0.1);
      border-radius: 8px;
    }

    .learning-feedback h3 {
      font-size: 16px;
      margin-bottom: 8px;
      color: var(--primary-color);
    }

    .learning-feedback p {
      font-size: 14px;
      line-height: 1.5;
      color: var(--text-color);
    }

    /* Add these styles to make the popup visible */
    .drill-summary-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .drill-summary-modal {
      background: white;
      padding: 24px;
      border-radius: 8px;
      max-width: 90%;
      width: 400px;
    }

    .score-big {
      font-size: 20px;
      font-weight: 600;
      text-align: center;
      margin: 16px 0;
    }

    .score-details {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-bottom: 24px;
    }

    .summary-actions {
      display: flex;
      gap: 16px;
    }

    .summary-actions button {
      flex: 1;
    }

    /* Adjust bottom section layout with more spacing */
    #step-2 .section-bottom .nav-buttons {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      gap: 24px; /* Increased gap between elements */
    }

    .upload-buttons-wrapper {
      flex: 1;
      display: flex;
      justify-content: center;
      max-width: 500px; /* Limit the width of the wrapper */
      margin: 0 auto; /* Center the wrapper */
    }

    #step-2 .upload-buttons {
      display: flex;
      gap: 8px;
      width: 100%;
    }

    #step-2 .upload-buttons .button {
      flex: 1;
      padding: 8px 16px;
      font-size: 13px;
      min-height: 36px;
    }

    #step-2 .back-button,
    #step-2 .next-button {
      flex: 0 0 auto;
    }

    /* Hide the original upload-buttons container in the middle section */
    .upload-container .upload-buttons {
      display: none;
    }

    /* Add this CSS rule */
    #step-1 .back-button {
      display: none;
    }

    /* Update the nav-buttons styling for step 1 */
    #step-1 .nav-buttons {
      display: flex;
      justify-content: flex-end; /* This will push the next button to the right */
    }

    .club-chips-container {
      max-height: 150px; /* Set a max height for the scrollable area */
      overflow-y: auto; /* Enable vertical scrolling */
      padding: 8px 0; /* Optional padding */
    }

    .current-step {
      display: flex; /* Use flexbox for alignment */
      padding: 4px 8px; /* Padding for spacing */
      justify-content: center; /* Center the content */
      align-items: center; /* Align items vertically */
      gap: 8px; /* Space between items */
      font-size: 12px;
      font-weight: bold;
      border-radius: 32px; /* Rounded corners */
      background: #E4DEFF; /* Background color */
    }

    /* Styles for the intro screen */
    #intro-screen {
      height: 100vh; /* Full height */
      width: 100%; /* Full width */
      display: flex;
      flex-direction: column; /* Stack children vertically */
      justify-content: center; /* Center content vertically */
      align-items: center; /* Center content horizontally */
      padding: 20px; /* Add padding to the intro screen for spacing */
    }

    .section-middle {
      display: flex;
      flex-direction: column; /* Stack image and list vertically */
      align-items: center; /* Center items */
      width: 100%; /* Full width */
      height: 100%; /* Set height to match other sections */
      justify-content: center; /* Center content vertically */
      padding: 16px; /* Optional padding for consistency */
    }

    .section-middle img {
      width: 100%; /* Image width */
      height: 100%;
      margin-bottom: 12px;
      border-radius: 12px; /* Rounded corners */
    }

    .section-middle ul {
      list-style-type: none; /* Remove default list styling */
      padding: 12px; /* Remove padding */
      width: 100%;
      height: 100%;
      margin: 0; /* Remove margin */
      text-align: left; /* Align text to the left */
    }

    .section-middle li {
      margin: 8px 0; /* Space between list items */
      font-size: 16px; /* Font size for list items */
      color: var(--text-color); /* Use existing text color variable */
    }

    .intro-content {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      text-align: center;
      gap: 32px;
      padding: 0px;
      width: 100%;
      box-sizing: border-box;
    }

    .intro-image {
      max-width: 100%; /* Ensure the image does not exceed the width of its container */
      height: auto; /* Maintain aspect ratio */
      object-fit: cover; /* Cover the area without distortion */
      border-radius: 12px;
      width: 100%; /* Make the image fill the container */
      max-height: 300px; /* Optional: limit the height to prevent overflow */
    }

    .intro-list {
      max-width: 600px; /* optional: prevent overly wide text on tablets */
      width: 100%;
      margin: 0 auto;   /* center if smaller than full width */
    }

    .intro-list h2 {
      font-size: 16px; /* Larger font size for the heading */
      color: var(--primary-color); /* Use primary color for the heading */
      margin-bottom: 12px; /* Space below the heading */
    }

    .intro-list ul {
      list-style-type: none; /* Remove default list styling */
      padding: 0; /* Remove padding */
      margin: 0; /* Remove margin */
    }

    .intro-list li {
      font-size: 12px; /* Font size for list items */
      color: var(--text-color); /* Use existing text color variable */
      margin-bottom: 8px; /* Space between list items */
    }

    .intro-image {
      width: 100%; /* Maintain the width */
      margin: 0; /* Remove all margins */
      display: block; /* Ensure it behaves as a block element */
      max-width: 100%; /* Ensure it scales down if needed */
      width: 100%;height: auto; /* Maintain aspect ratio */
      padding: 0; /* Remove any padding */
    }

    #intro-screen .intro-image {
      margin: 0; /* Remove all margins */
    }

    .learning-suggestion {
      background-color: rgba(255, 255, 255, 0.9); /* Very light background */
      border-radius: 8px; /* Rounded corners */
      padding: 6px; /* Padding for spacing */
      margin: 12px; /* Space above the suggestion */
    }

    .learning-suggestion h3 {
      font-size: 14px; /* Smaller font size for the heading */
      margin-bottom: 8px; /* Space below the heading */
    }

    .learning-suggestion p {
      font-size: 12px; /* Smaller font size for the paragraph */
      margin: 0; /* Remove default margin */
    }

    .pill {
      display: inline-block; /* Make it inline-block for pill effect */
      padding: 8px 12px; /* Padding for the pill */
      border-radius: 20px; /* Rounded corners */
      font-size: 12px; /* Font size */
      font-weight: bold;
      color: white; /* Text color */
      margin-right: 8px; /* Space between pills */
    }

    .hits-pill {
      background-color: #34c759; /* Green background for hits */
    }

    .misses-pill {
      background-color: #ff3b30; /* Red background for misses */
    }

    .highlight.club-name {
      font-size: 16px; /* Adjust the size as needed */
      font-weight: bold; /* Optional: reinforces the emphasis */
    }

    .shank-button {
      margin-bottom: 10px; /* Add some space below the button */
      padding: 10px 20px; /* Add padding */
      margin-top: 20px;
      background-color: rgba(107, 78, 255, 0.7); /* Background color */
      color: white; /* Text color */
      border: none; /* Remove default border */
      border-radius: 5px; /* Rounded corners */
      font-size: 16px; /* Font size */
      cursor: pointer; /* Pointer cursor on hover */
      transition: background-color 0.3s; /* Smooth transition */
    }

    .shank-button:hover {
      background-color: rgba(107, 78, 255, 1); /* Darker on hover */
    }

    /* Portrait orientation adjustments */
    @media only screen and (orientation: portrait) {
      /* Change drill container to a vertical stack */
      .drill-container {
        flex-direction: column;
        gap: 16px;
      }
      /* Stack the instruction panel and field interaction vertically */
      .instruction-panel,
      .field-interaction {
        width: 100%;
      }
      /* Adjust confirm container for portrait */
      .confirm-container {
        flex-direction: column;
        gap: 16px;
      }
      .club-summary,
      .photo-preview {
        width: 100%;
        max-width: 100%;
        padding-top: 56.25%;

      }
      /* Also, for the intro content, stack image and list vertically */
      .intro-content {
        flex-direction: column;
        gap: 40px;
      }
    }

    .spinner-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none; /* Hidden by default */
      justify-content: center;
      align-items: center;
      background-color: rgba(255, 255, 255, 0.8);
      z-index: 9999; /* Ensure it stays on top */
    }

    .spinner {
      width: 60px;
      height: 60px;
      border: 8px solid #f3f3f3; /* Light gray */
      border-top: 8px solid var(--primary-color); /* Your main purple */
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0%   { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Portrait orientation: stack vertically */
    @media only screen and (orientation: portrait) {
      .intro-content {
        flex-direction: column; /* stack image over text */
      }

      .intro-image {
        width: 100%; /* fill container width in portrait */
      }

      .intro-list {
        width: 100%;  /* also fill container in portrait */
      }
    }

    /* Landscape orientation: place image and text side-by-side */
    @media only screen and (orientation: landscape) {
      .intro-content {
        flex-direction: row; /* side by side */
      }

      .intro-image {
        width: 40%;  /* or whatever proportion you prefer */
      }

      .intro-list {
        width: 60%;  /* match the image proportion */
      }
    }

    .upload-buttons-wrapper .default-button {
      background: none !important; /* Remove background */
      color: var(--primary-color); /* Set text color */
      text-decoration: underline; /* Underline the text */
      border: none; /* Remove border */
      cursor: pointer; /* Pointer cursor on hover */
      font-size: 14px; /* Font size */
      padding: 12px 0; /* Padding for spacing */
      transition: color 0.3s ease; /* Smooth color transition */
    }

    .upload-buttons-wrapper .default-button:hover {
      color: #5b3eff; /* Change color on hover */
    }

    .edit-field {
      width: 100%; /* Full width */
      background: white; /* Optional: background color */
      border: 1px solid var(--border-color); /* Optional: border */
      border-radius: 8px; /* Rounded corners */
      padding: 12px; /* Padding for the button */
      cursor: pointer; /* Pointer cursor on hover */
      margin-top: 8px; /* Space above the button */
    }
  </style>
</head>
<body>
  <!-- ADD THIS RIGHT AFTER <body> OPENS (or at the very end before </body>): -->
  <div id="loading-spinner" class="spinner-container">
    <div class="spinner"></div>
  </div>
  
  <!-- Intro Screen -->
  <div id="intro-screen" class="step active">
    <div class="section-top">
      <div class="step-indicator">INTRODUCTION</div>
      <h1>Welcome to the Distance Drill</h1>
    </div>

    <div class="section-middle">
      <div class="intro-content">
        <img src="https://x8ki-letl-twmt.n7.xano.io/vault/kI1kGqUb/3SHDB_cAqv9oGrMACE6VsRPr3Rk/dP6uYQ../golf_intro.jpg" class="intro-image" alt="Golf Intro" />
        <div class="intro-list">
          <h2>About this drill</h2>
          <ul>
            <li>üéØ Practice hitting targets with precision and accuracy.</li>
            <li>üìä Get instant feedback on your shot placement.</li>
            <li>üìà Earn a performance summary to improve your aim and game.</li>
            <li>üíæ Save your session and score to your profile for future tracking and progress analysis.</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="section-bottom">
      <div class="nav-buttons">
        <button class="button primary" onclick="goToStep1()">GO TO STEP 1</button>
      </div>
    </div>
  </div>

  <!-- Club Selection Screen -->
  <div id="step-1" class="step">
    <div class="section-top">
      <div class="step-indicator">STEP 1/3</div>
      <h1>Choose your clubs</h1>
    </div>

    <div class="section-middle">
      <div class="content-wrapper">
        <div id="club-selection" class="club-selection">
          <!-- Clubs will be loaded from API -->
        </div>
      </div>
    </div>

    <div class="section-bottom">
      <div class="nav-buttons">
        <button class="back-button">‚Üê BACK</button>
        <button class="button primary" onclick="goToStep(2)">NEXT ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- Step 2: Field Photo -->
  <div id="step-2" class="step">
    <div class="section-top">
      <div class="step-indicator">STEP 2/3</div>
      <h1>Take a photo of your field</h1>
    </div>

    <div class="section-middle">
      <div class="content-wrapper">
        <div class="upload-container">
          <div class="preview-wrapper">
            <div class="preview-area empty" id="preview-area">
              <img src="https://x8ki-letl-twmt.n7.xano.io/vault/kI1kGqUb/ooPK4v_D7dq8Xn6p0gQrAoKzUrI/yt6c4g../placeholder_right.jpg" id="preview-image" class="preview-image" alt="Field preview">
            </div>
          </div>
          
          <div class="upload-text">
            <div class="main-text">Upload a photo of your field</div>
            <div class="subtitle">Make sure the whole field is visible</div>
          </div>
          
          <div class="upload-buttons-wrapper">
            <button class="upload-button">üì∏ Upload a photo</button>
            <button class="default-button">üéØ Use default photo</button>
          </div>
        </div>
        <input type="file" id="photo-input" accept="image/*" style="display: none" onchange="handlePhotoUpload(event)">
      </div>
    </div>

    <div class="section-bottom">
      <div class="nav-buttons">
        <button class="back-button" onclick="goToStep(1)">‚Üê BACK</button>
        <button class="button primary next-button" onclick="goToStep(3)">NEXT ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- Step 3: Confirmation -->
  <div id="step-3" class="step">
    <div class="section-top">
      <div class="step-indicator">STEP 3/3</div>
      <h1>Confirm your clubs and field photo</h1>
    </div>

    <div class="section-middle">
      <div class="content-wrapper">
        <div class="confirm-container">
          <div class="club-summary">
            <div class="club-chips-container">
              <div class="club-chips">
                <div class="selected-clubs-list"></div>
              </div>
            </div>
            <button class="edit-clubs" onclick="goToStep(1)">EDIT CLUBS</button>
          </div>
          <div class="photo-preview">
            <img src="https://x8ki-letl-twmt.n7.xano.io/vault/kI1kGqUb/Wr9F6KsnNfIsTUD2gBV_7fZkV2A/LyWAUA../default_field.png" alt="Field preview" id="confirm-preview-image">
          </div>
          <button class="edit-field" onclick="goToStep(2)">EDIT FIELD</button>
        </div>
      </div>
    </div>

    <div class="section-bottom">
      <div class="nav-buttons">
        <button class="back-button" onclick="goToStep(2)">‚Üê BACK</button>
        <button class="button primary" onclick="startDrill()">START DRILL ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- Step 4: Drill Interface -->
  <div id="step-4" class="step">
    <div class="section-top">
      <div class="step-indicator">DRILL EXERCISE</div>
      <h1>Follow the instructions below</h1>
    </div>

    <div class="section-middle">
      <div class="drill-container">
        <div class="instruction-panel">
          <div class="progress-header">
            <div class="current-step">1/25</div>
            <div class="score-tracker">üéØ Hits: <span class="score">0</span>/25</div>
          </div>
          <div class="instruction">
            Use your <span class="highlight club-name">Loading...</span> to hit the <span class="highlight target-area">Loading...</span>.
          </div>
          <div class="parent-container">
            <div class="feedback-message"></div>
            <button class="shank-button">‚ùå SHANK</button>
            <div class="prompt">
              <h3>Where did your ball land?</h3>
              <p class="hint">Tap on the image to move to the next target ‚Üí</p>
            </div>
          </div>
        </div>
        
        <div class="field-interaction">
          <div class="field-container">
            <img src="" alt="Golf field" id="field-image">
            <div class="interactive-zones">
              <div class="zone" data-zone="zone-1">
                <div class="aim-here-text">‚¨ÜÔ∏è HERE ‚¨ÜÔ∏è</div>
              </div>
              <div class="zone" data-zone="zone-2">
                <div class="aim-here-text">‚¨ÜÔ∏è HERE ‚¨ÜÔ∏è</div>
              </div>
              <div class="zone" data-zone="zone-3">
                <div class="aim-here-text">‚¨ÜÔ∏è HERE ‚¨ÜÔ∏è</div>
              </div>
              <div class="zone" data-zone="zone-4">
                <div class="aim-here-text">‚¨ÜÔ∏è HERE ‚¨ÜÔ∏è</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="section-bottom">
      <div class="nav-buttons">
        <button class="back-button" onclick="goToStep(1)">‚ùå EXIT DRILL</button>
        <button class="button" onclick="restartDrill()">üîÑ RESTART DRILL</button>
      </div>
    </div>
  </div>

  <script>
    const DEFAULT_PHOTO_URL = 'https://x8ki-letl-twmt.n7.xano.io/vault/kI1kGqUb/Wr9F6KsnNfIsTUD2gBV_7fZkV2A/LyWAUA../default_field.png';
    let uploadedPhotoUrl = null;
    let selectedClubs = [];
    let drillTargets = [];
    let currentStep = 1;
    const totalSteps = 25;
    let drillScore = 0;
    let drillResults = [];
    let shankCount = 0;

    function initializeClubs() {
      // 1) Grab the spinner container
      const spinner = document.getElementById('loading-spinner');

      // 2) Show it right before fetching clubs
      spinner.style.display = 'flex';

      fetch('https://x8ki-letl-twmt.n7.xano.io/api:_A2_qq4E/golf_clubs')
        .then(response => {
          if (!response.ok) throw new Error('Failed to load clubs');
          return response.json();
        })
        .then(clubs => {
          // Hide spinner on success
          spinner.style.display = 'none';

          const clubSelection = document.querySelector('.club-selection');
          clubSelection.innerHTML = '';
          clubs.forEach(club => {
            const button = document.createElement('button');
            button.className = 'club-option';
            button.textContent = `${club.club_name} / max: ${club.max_distance}`;
            button.setAttribute('aria-label', `Select ${club.club_name}`);
            button.onclick = () => handleClubSelection(button);
            clubSelection.appendChild(button);
          });
        })
        .catch(error => {
          console.error('Error loading clubs:', error);
          // Hide spinner on error
          spinner.style.display = 'none';

          const clubSelection = document.querySelector('.club-selection');
          clubSelection.innerHTML = `
            <div class="error-message">
              Failed to load clubs.
              <button onclick="initializeClubs()">Try Again</button>
            </div>
          `;
        });
    }

    function handleClubSelection(button) {
      const wasSelected = button.classList.contains('selected');
      if (wasSelected) {
        button.classList.remove('selected');
        selectedClubs = selectedClubs.filter(c => c !== button.textContent);
      } else {
        button.classList.add('selected');
        selectedClubs.push(button.textContent);
      }
      updateBravoVariable('selectedClubs', selectedClubs);
    }

    function handlePhotoUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          uploadedPhotoUrl = e.target.result;
          updateBravoVariable('uploadedPhotoUrl', uploadedPhotoUrl);
          // Update preview areas...
        };
        reader.readAsDataURL(file);
      }
    }

    function handlePhotoSelection(isDefault = false) {
      const previewArea = document.getElementById('preview-area');
      const previewImage = document.getElementById('preview-image');
      const nextButton = document.querySelector('.next-button');

      if (isDefault) {
        previewImage.src = DEFAULT_PHOTO_URL;
        uploadedPhotoUrl = DEFAULT_PHOTO_URL;
        previewArea.classList.remove('empty');
        nextButton.disabled = false;
        return;
      }

      const fileInput = document.createElement('input');
      fileInput.type = 'file';
      fileInput.accept = 'image/*';

      fileInput.onchange = function(e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(event) {
            uploadedPhotoUrl = event.target.result;
            previewImage.src = uploadedPhotoUrl;
            previewArea.classList.remove('empty');
            nextButton.disabled = false;
          };
          reader.readAsDataURL(file);
        }
      };

      fileInput.click();
    }

    // Navigation between steps
    function goToStep(step) {
      // Validate before proceeding
      if (step === 2 && selectedClubs.length === 0) {
        alert('Please select at least one club before proceeding.');
        return;
      }

      if (step === 3 && !document.getElementById('preview-image').src) {
        alert('Please upload a photo or use the default field before proceeding.');
        return;
      }

      // Make sure step is within valid range
      if (step < 1 || step > 4) return;  // Add this safety check

      const currentStepEl = document.querySelector('.step.active');
      const targetStepEl = document.getElementById(`step-${step}`);

      if (currentStepEl) currentStepEl.classList.remove('active');
      if (targetStepEl) targetStepEl.classList.add('active');

      // Initialize step 3 if that's where we're going
      if (step === 3) {
        initializeConfirmScreen();
      }

      updateBravoVariable('currentStep', step);

      // Initialize step-specific content...
    }

    function initializeConfirmScreen() {
      const clubsList = document.querySelector('.selected-clubs-list');
      if (!clubsList) return;

      // Clear existing clubs
      clubsList.innerHTML = '';

      // Add each selected club as a pill
      selectedClubs.forEach(club => {
        const pill = document.createElement('div');
        pill.className = 'club-pill';
        pill.textContent = club;
        clubsList.appendChild(pill);
      });

      // Update photo preview
      const confirmPreview = document.getElementById('confirm-preview-image');
      if (confirmPreview) {
        confirmPreview.src = uploadedPhotoUrl || DEFAULT_PHOTO_URL;
      }
    }

    function startDrill() {
      currentStep = 1;
      drillScore = 0;
      drillTargets = generateTargets(selectedClubs);

      const fieldImage = document.getElementById('field-image');
      if (fieldImage) {
        fieldImage.src = uploadedPhotoUrl || DEFAULT_PHOTO_URL;
      }

      updateDrillUI();
      goToStep(4);
    }

    function updateDrillUI() {
      const currentTarget = drillTargets[currentStep - 1];
      console.log('Current Target:', currentTarget); // Log current target

      // Clear previous highlights
      document.querySelectorAll('.zone').forEach(zone => {
        zone.classList.remove('highlighted');
      });

      // Highlight the current target zone
      const targetZone = document.querySelector(`.zone[data-zone="${currentTarget.area}"]`);
      console.log('Target Zone:', targetZone); // Log target zone

      if (targetZone) {
        targetZone.classList.add('highlighted');
      }

      // Update step and score
      document.querySelector('.current-step').textContent = `${currentStep}/${totalSteps}`;
      document.querySelector('.score').textContent = drillScore;

      // Update instruction
      document.querySelector('.club-name').textContent = currentTarget.club;
      document.querySelector('.target-area').textContent = currentTarget.area;

      // Clear previous feedback
      document.querySelector('.feedback-message').className = 'feedback-message';

      // Reset zone highlighting
      //document.querySelectorAll('.zone').forEach(zone => {
      //  zone.className = 'zone';
      //});
    }

    function handleZoneClick(selectedZone) {
      const currentTarget = drillTargets[currentStep - 1];
      const targetArea = currentTarget.area;
      const isCorrect = selectedZone === targetArea;

      // Store result for summary
      drillResults.push({
        expectedTarget: targetArea,
        actualHit: selectedZone,
        isCorrect: isCorrect
      });

      // Show feedback
      const feedbackMessage = document.querySelector('.feedback-message');
      const clickedZone = document.querySelector(`[data-zone="${selectedZone}"]`);

      if (isCorrect) {
        drillScore++;
        updateBravoVariable('drillScore', drillScore);
        feedbackMessage.textContent = 'Great shot! üéØ';
        feedbackMessage.className = 'feedback-message success';
        clickedZone.classList.add('correct');
      } else {
        feedbackMessage.textContent = 'Miss! Try again';
        feedbackMessage.className = 'feedback-message error';
        clickedZone.classList.add('incorrect');
      }

      // Update score immediately
      document.querySelector('.score').textContent = drillScore;

      // Get references to the feedback message, prompt, and hint
      const prompt = document.querySelector('.prompt');
      const hint = document.querySelector('.hint');

      // Show feedback message
      feedbackMessage.textContent = isCorrect ? 'Great shot! üéØ' : 'Miss! Try again';
      feedbackMessage.classList.add('visible');

      // Hide prompt and hint
      prompt.classList.add('hidden');
      hint.classList.add('hidden');

      // Wait a moment before moving to the next step or finishing
      setTimeout(() => {
        // Hide feedback message
        feedbackMessage.classList.remove('visible');

        // Remove the overlay classes from the clicked zone
        clickedZone.classList.remove('correct', 'incorrect');

        // Show prompt and hint again
        prompt.classList.remove('hidden');
        hint.classList.remove('hidden');

        // Proceed with the next steps...
        if (currentStep < totalSteps) {
          currentStep++;
          updateDrillUI();
        } else {
          finishDrill();
        }
      }, 1500); // Adjust the duration as needed
    }

    function finishDrill() {
      const hits = drillScore;
      const misses = totalSteps - hits;

      const { learningSuggestion } = calculateAccuracyAndSuggestion();

      const summaryHTML = `
        <div class="drill-summary-overlay">
          <div class="drill-summary-modal">
            <h3>Great job! üéØ</h3>
            <div class="final-score">
              <div class="score-big">Your score: ${hits}/${totalSteps}</div>
              <div class="score-details">
                <div class="pill hits-pill">Hits: ${hits}</div>
                <div class="pill misses-pill">Misses: ${misses}</div>
              </div>
            </div>
            <div class="learning-suggestion">
              <h3>Learning Suggestion:</h3>
              <p>${learningSuggestion}</p>
            </div>
            <div class="summary-actions">
              <button class="button" onclick="restartDrill()">Restart drill</button>
              <button class="button primary" onclick="saveDrillSession(); finishDrill();">Save session</button>
            </div>
          </div>
        </div>
      `;

      document.body.insertAdjacentHTML('beforeend', summaryHTML);
    }

    async function saveDrillSession() {
      try {
        const userId = getUserIdFromUrl();
        if (!userId) {
          throw new Error('No user ID provided');
        }

        const {
          expectedTargets,
          actualHits,
          accuracyScore,
          learningSuggestion
        } = calculateAccuracyAndSuggestion();

        const requestBody = {
          payload: {
            user_id: userId,
            drill_type: 'distance',
            final_score: drillScore,
            total_attempts: totalSteps,
            expected_targets: expectedTargets,
            actual_hits: actualHits,
            accuracy_score: accuracyScore,
            shanks: shankCount,
            learning_suggestion: learningSuggestion,
            completed_at: new Date().toISOString()
          }
        };

        console.log('Sending request:', requestBody);

        const response = await fetch('https://x8ki-letl-twmt.n7.xano.io/api:SQlmPpOk/distance_drill/log_session', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(requestBody)
        });

        if (!response.ok) {
          const errorData = await response.text();
          console.error('Server response:', errorData);
          throw new Error(`Server responded with ${response.status}: ${errorData}`);
        }

        const data = await response.json();
        console.log('Success response:', data);

        alert('Session saved successfully!');
        // No modal removal, no redirect

      } catch (error) {
        console.error('Error saving session:', error);
        alert('Error saving session: ' + error.message);
      }
    }

    function calculateAccuracyAndSuggestion() {
      let rightMisses = 0;
      let leftMisses = 0;
      let correctHits = 0;

      const expectedTargets = drillResults.map(r => r.expectedTarget);
      const actualHits = drillResults.map(r => r.actualHit);

      drillResults.forEach(result => {
        if (result.isCorrect) {
          correctHits++;
        } else if (result.actualHit === 'right') {
          rightMisses++;
        } else if (result.actualHit === 'left') {
          leftMisses++;
        }
      });

      // Generate suggestion based on pattern
      let suggestion;
      if (correctHits >= 20) {
        suggestion = "Excellent work! You're consistently hitting your targets. Keep it up!";
      } else if (correctHits >= 15) {
        suggestion = "Good job! You're getting the hang of it. Focus on refining your aim.";
      } else if (correctHits >= 10) {
        suggestion = "You're making progress! Try to focus on your stance and swing for better accuracy.";
      } else if (correctHits >= 5) {
        suggestion = "You're starting to find your rhythm. Keep practicing to improve your consistency.";
      } else if (correctHits === 0) {
        suggestion = "It looks like you struggled with accuracy. Consider working on ball control and target alignment.";
      } else {
        suggestion = "Your shots are inconsistent. Try focusing on your stance and swing precision.";
      }

      return {
        expectedTargets,
        actualHits,
        accuracyScore: correctHits,
        learningSuggestion: suggestion
      };
    }

    // Update back button functionality
    document.querySelectorAll('.back-button').forEach(button => {
      button.removeEventListener('click', () => {});  // Remove any existing listeners
      button.addEventListener('click', function() {
        const currentStepEl = document.querySelector('.step.active');
        if (currentStepEl) {
          const currentStep = parseInt(currentStepEl.id.split('-')[1]);
          // Always go to the previous step number
          goToStep(currentStep - 1);
        }
      });
    });

    // Initialize on load
    document.addEventListener('DOMContentLoaded', function() {
      initializeClubs();

      // Add click handler to the shank button
      const shankButton = document.querySelector('.shank-button');
      if (shankButton) {
        shankButton.addEventListener('click', handleShank);
      }
    });

    // Update CSS for edit buttons
    const editButtonStyles = `
      .edit-clubs,
      .edit-field {
        background: white;
        color: #5B3DDE;
        padding: 12px 24px;
        border-radius: 8px;
        border: 0.5px solid #5B3DDE;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .edit-clubs:hover,
      .edit-field:hover {
        background: #f0f0f0;
      }
    `;

    // Add the styles to the document
    const styleSheet = document.createElement("style");
    styleSheet.textContent = editButtonStyles;
    document.head.appendChild(styleSheet);

    // Add click handlers to zones
    document.querySelectorAll('.zone').forEach(zone => {
      zone.addEventListener('click', () => handleZoneClick(zone.dataset.zone));
    });

    function generateTargets(selectedClubs) {
      const areas = ['zone-1', 'zone-2', 'zone-3', 'zone-4'];
      let targets = [];

      while (targets.length < totalSteps) {
        const randomClub = selectedClubs[Math.floor(Math.random() * selectedClubs.length)];
        const randomArea = areas[Math.floor(Math.random() * areas.length)];
        targets.push({
          club: randomClub,
          area: randomArea
        });
      }

      return targets;
    }

    function updateBravoVariable(name, value) {
      const message = {
        "action": "set-variable",
        "params": { "name": name, "value": value }
      };
      if (window.bravo) {
        window.bravo.postMessage(message);
      }
    }

    function restartDrill() {
      // Remove the summary modal
      const overlay = document.querySelector('.drill-summary-overlay');
      if (overlay) {
        overlay.remove();
      }

      // Reset drill state
      currentStep = 1;
      drillScore = 0;
      drillResults = [];
      shankCount = 0;  // Reset shank count

      // Start a new drill
      startDrill();

      // Update Bravo variables
      updateBravoVariable('drillScore', drillScore);
      updateBravoVariable('currentStep', currentStep);
      updateBravoVariable('shankCount', shankCount);
    }

    // Add click handlers to your buttons
    document.querySelector('.default-button').addEventListener('click', () => handlePhotoSelection(true));
    document.querySelector('.upload-button').addEventListener('click', () => handlePhotoSelection(false));

    function goToStep1() {
      // Hide the intro screen
      const introScreen = document.getElementById('intro-screen');
      if (introScreen) {
        introScreen.classList.remove('step', 'active'); // Ensure both classes are removed
      }

      // Hide all other steps
      const allSteps = document.querySelectorAll('.step');
      allSteps.forEach(step => {
        step.classList.remove('active'); // Hide all steps
      });

      // Show the club selection screen (Step 1)
      const step1 = document.getElementById('step-1');
      if (step1) {
        step1.classList.add('step', 'active'); // Ensure both classes are added
      }

      // Ensure the intro screen is not displayed
      if (introScreen.style.display !== 'none') {
        introScreen.style.display = 'none'; // Explicitly hide the intro screen
      }
    }

    function handleShank() {
      // Increment the shank counter
      shankCount++;
      updateBravoVariable('shankCount', shankCount);

      // Provide user feedback for a shank
      const feedbackMessage = document.querySelector('.feedback-message');
      feedbackMessage.textContent = 'Shanked! Give it another try!';
      feedbackMessage.className = 'feedback-message';
      feedbackMessage.classList.add('visible');

      // Hide feedback after 1 second
      setTimeout(() => {
        feedbackMessage.classList.remove('visible');
      }, 1000);

      // Do NOT increment currentStep here so the attempt is not used up.
      // The same target remains, allowing the user to try again.
      // No call to updateDrillUI() or finishDrill() here
    }

    function getUserIdFromUrl() {
      const urlParams = new URLSearchParams(window.location.search);
      const userId = urlParams.get('user_id');
      return userId ? parseInt(userId) : null; // Convert to number or return null if not found
    }
  </script>
</body>
</html>
